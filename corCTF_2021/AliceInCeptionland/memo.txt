>>> file AliceInCeptionland.exe
AliceInCeptionland.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows

C# decompiler: dnSpy

iv, keyë¥¼ êµ¬í•´ì•¼ í•˜ëŠ” ê²ƒ ê°™ë‹¤. aes ì•”í˜¸í™”ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ë‹¤. 
iv, keyëŠ” Foo, Barë¥¼ í•´ì‹±í•œ ê°’ì´ë‹¤. 
Foo, BarëŠ” image 1, 2ì— ë„ë‹¬í–ˆì„ ë•Œ cheshirecat.Secret, caterpillar.Secretë¡œ ë°”ë€ë‹¤. 
cheshirecatì˜ Secretì€ button1_Click í•¨ìˆ˜ì—ì„œ íŠ¹ì •ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ textBox1.Textë¡œ ë°”ë€ë‹¤. ì¡°ê±´ì´ ë˜ê²Œ ë¦¬ë²„ì‹±ìŠ¤ëŸ½ë‹¤. 

str = str.reverse()
text = "41!ce1337"
str[i] ^= text[i % len(text)]
str.reverse() == "oI!&}IusoKs ?Ytr"
// str = [92, 120, 68, 69, 92, 120, 65, 68, 92, 120, 66, 69, 92, 120, 69, 70] = '\\xDE\\xAD\\xBE\\xEF'

str = str.reverse()
text = "c4t3rp1114rz_s3cr3t1y_ru13_7h3_w0r1d"
rol(str[i], 114)
str[i] += 222
str[i] ^= text[i % len(text)]
str[i] -= 127
rol(str[i], 6)
str.reverse() == "\0R\u009c\u007f\u0016ndC\u0005Ã®\u0093MÃ­ÃƒÃ—\u007f\u0093\u0090\u007fS}Â­\u0093)Ã¿Ãƒ\f0\u0093g/\u0003\u0093+ÃƒÂ¶\0Rt\u007f\u0016\u0087dC\aÃ®\u0093pÃ­Ãƒ8\u007f\u0093\u0093\u007fSzÂ­\u0093Ã‡Ã¿ÃƒÃ“0\u0093\u0086/\u0003q"
// str = [92, 120, 52, 92, 120, 76, 92, 120, 49, 92, 120, 67, 92, 120, 51, 92, 120, 49, 92, 120, 83, 92, 120, 78, 92, 120, 48, 92, 120, 84, 92, 120, 52, 92, 120, 83, 92, 120, 76, 92, 120, 51, 92, 120, 51, 92, 120, 80, 92, 120, 83, 92, 120, 52, 92, 120, 86, 92, 120, 51, 92, 120, 72, 92, 120, 51, 92, 120, 82] = '\\x4\\xL\\x1\\xC\\x3\\x1\\xS\\xN\\x0\\xT\\x4\\xS\\xL\\x3\\x3\\xP\\xS\\x4\\xV\\x3\\xH\\x3\\xR'

iv = c591082b809232873d024ed22c2c5252 = 'Ã…â€˜+â‚¬â€™2â€¡=NÃ’,,RR'
key = a0405828ddd12f6a0fb868feead857292bbaeb2779e1100774855d365a517ff5 = 'Â @X(ÃÃ‘/jÂ¸hÃ¾ÃªÃ˜W)+ÂºÃ«'yÃ¡tâ€¦]6ZQÃµ'
padding: PKCS7

ì›ë¬¸ì„ ë”°ë¡œ ì°¾ì•„ì•¼í•˜ëŠ” ê²ƒ ê°™ë‹¤. 
AliceInCeptiondreamì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

pycryptodomexë¥¼ ê¹”ê³ , ë¸”ë¡œê·¸ ì½”ë“œë¥¼ ì ë‹¹íˆ ê°€ì ¸ì™€ì„œ ë³µí˜¸í™”ë¥¼ í•œë‹¤. 
ë³µí˜¸í™”ë¥¼ í•´ë„ ë©”ëª¨ì¥ì—ì„œ ë³´ì´ëŠ” ê²ƒì€ ì—†ê³ , hexë¡œ ì—´ì–´ë³¸ë‹¤. ëˆˆì— ë„ëŠ” ê²ƒì€ ë”±íˆ ì—†ë‹¤. 
íŒŒì¼ ì‹œê·¸ë‹ˆì³ë¥¼ ì°¾ì•„ë³¸ë‹¤. íŠ¹ì´í•´ë³´ì´ëŠ” ë¶€ë¶„ë¬¸ìì—´ì€ ì—†ê³ , ë‹¤ë¥¸ íŒŒì¼ í˜•ì‹ë„ ì•„ë‹Œ ê²ƒ ê°™ë‹¤. 
ë¹„ìŠ·í•œ ìœ ë‹ˆì½”ë“œê°€ ë§ì´ ë³´ì¸ë‹¤. flagê°€ ë  ìˆ˜ ìˆëŠ” ë¬¸ìë§Œ ë‚¨ê²¨ë„ ì˜ë¯¸ìˆëŠ” ì •ë³´ëŠ” ì—†ë‹¤. 
í•´ì‹±ì´ë‚˜ ë³µí˜¸í™”ë¥¼ ì˜ëª»í•´ì„œ ì˜ëª»ë‚˜ì™”ë˜ ê²ƒ ê°™ë‹¤. ì œëŒ€ë¡œ ë³µí˜¸í™”í•˜ë©´ exe íŒŒì¼ì´ ë‚˜ì˜¨ë‹¤. 


ì›ë˜ í”„ë¡œê·¸ë¨ì˜ Mainì˜ ë§ˆì§€ë§‰ ë¶€ë¶„ì€ ë¦¬ì†ŒìŠ¤ë¥¼ decryptí•´ì„œ assemblyë¡œ ë§Œë“  í›„, DeepDream ìƒì„±ìì— ì¸ìë¡œ ë„˜ê²¨ì„œ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì´ì—ˆë‹¤. ì´ ì–´ì…ˆë¸”ë¦¬ëŠ” Dream ë³€ìˆ˜ì— ì €ì¥ëœë‹¤. 
DeepDreamì˜ button1_Clickì—ì„œëŠ” Dreamì˜ Encode(textBox1.Text)ê°€ íŠ¹ì • ë¬¸ìì—´ì¸ì§€ í™•ì¸í•œë‹¤. 
// dest = "3c3cf1df89fe832aefcc22fc82017cd57bef01df54235e21414122d78a9d88cfef3cf10c829ee32ae4ef01dfa1951cd51b7b22fc82433ef7ef418cdf8a9d802101ef64f9a495268fef18d52882324f217b1bd64b82017cd57bef01df255288f7593922712c958029e7efccdf081f8808a6efd5287595f821482822f6cb95f821cceff4695495268fefe72ad7821a67ae0060ad"

DeepDreamì˜ button2_Clickì—ì„œëŠ” Dreamì˜ Decrypt(array, textBox1.Text)ì˜ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤. arrayëŠ” const[]ë‹¤. ì´ ê²°ê³¼ê°€ flagì¸ ê²ƒ ê°™ë‹¤. 
// array = [152, 52, 210, 108, 209, 182, 69, 150, 153, 40, 64, 133, 135, 200, 181, 146, 187, 125, 217, 241, 62, 251, 72, 128, 232, 134, 143, 221, 236, 15, 120, 21, 213, 43, 99, 72, 163, 243, 21, 217, 41, 81, 246, 174, 229, 49, 10, 200, 70, 138, 103, 174, 160, 80, 66, 99, 250, 166, 73, 217, 220, 94, 146, 153, 150, 43, 120, 46, 150, 203, 20, 198, 211, 89, 35, 134, 89, 132, 190, 205, 141, 237, 201, 119, 178, 47, 211, 182, 156, 56, 17, 111, 146, 167, 228, 133, 51, 187, 48, 213, 206, 208, 254, 71, 205, 76, 36, 119, 32, 204, 50, 217, 167, 42, 224, 80, 91, 102, 225, 152, 14, 94, 73, 60, 145, 152, 240, 188, 182, 190, 182, 166, 98, 5, 234, 116, 229, 27, 90, 255, 109, 15, 219, 83, 34, 15, 22, 147, 170, 234, 184, 109, 28, 1, 3, 178, 98, 31, 49, 250, 163, 196, 139, 204, 177, 95, 239, 172, 138, 50, 189, 238, 57, 177, 110, 206]

button1 ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” textì— ëŒ€í•´, aes_decrypt(ciphertext=array, iv=md5(text), key=sha256(text))ë¥¼ ì ìš©í•˜ë©´ flagë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. 


button1 ì¡°ê±´:
xm = 1056017893861212352
rm = ['', '', '', '', '\x0f', '\x05\x06\x05\x05\x06', '\x1d\x1d\x1d\x1d\x1d', '\x15\x15\x15\x16\x16', 'nmmnmn', 'ffff', '~}}~', 'uvvu', '\x00', 'FFFF', '^]]^', 'UVVU', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\x0c\x0f\x0c\x0f\x0c\x0c', '\x04\x07\x04\x04\x07\x04', '\x1f\x1c\x1c\x1c\x1c', '\x14\x14\x14\x14\x17', 'ol', 'gg', '||\x7f|', 'twtt', 'OL', 'GG', '\\\\_\\', 'TWTT', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\x00', '\x00', '\x1c\x1c\x1f\x1f\x1f', '\x17\x17\x17\x14\x14\x14', 'olll', 'dggg', '|\x7f|', 'wwtt', 'OLLL', 'DGGG', '\\_\\', 'WWTT', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\x00', '\x05\x06\x05\x06\x05', '\x1d\x1d\x1d\x1e\x1e', '\x16\x15\x16\x15\x16\x15', 'nmnm', 'fef', '}}}', '\x00', 'NMNM', 'FEF', ']]]', '\x00', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\n\n\n\n\n', '\x01\x01\x02\x02\x01\x01', '\x1a\x1a\x1a\x1a\x19', '\x00', 'ijj', 'babb', 'y', '\x00', 'IJJ', 'BABB', 'Y', '\x00', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\x00', '\x00\x03\x03\x03\x03\x00', '\x1b\x1b\x1b\x1b\x1b', '\x10\x13\x13\x13\x10', 'k', '``', '{{x', '\x00', 'K', '@@', '[[X', '\x00', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\x08\x0b\x08\x08\x08', '\x00\x03\x00\x03\x00\x03', '\x1b\x18\x18\x18\x18', '\x00', 'hhkh', 'c`', 'xxx{', '\x00', 'HHKH', 'C@', 'XXX[', '\x00', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '\t\n\n\n\n\t', '\x02\x01\x01\x02\x01', '\x1a\x1a\x19\x19\x19', '\x11\x11\x12\x12\x11\x11', 'jji', 'bbb', 'yzz', 'qqrrqr', 'JJI', 'BBB', 'YZZ', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']
array = [xm & 255, xm >> 8 & 255, xm >> 16 & 255, xm >> 24 & 255, xm >> 32 & 255, xm >> 40 & 255, xm >> 48 & 255, xm >> 56 & 255]


t1 = '/'.join([f(c) for c in plain])
t2 = ''.join([hex(t1[i] ^ array[i % len(array)]) for i in range(len(t))])
if(???)	t2 = t2.reverse()
assert t == dest

ë’¤ì—ì„œë¶€í„° ì—­ìœ¼ë¡œ ì‹¤í–‰í–ˆì„ ë•Œ, reverseê°€ ì‹¤í–‰ë˜ë©´ /ê°€ ë“±ì¥í•˜ì§€ ì•Šê³ , ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë©´ ì ì ˆí•˜ê²Œ ë“±ì¥í•œë‹¤. 
[f(c) for c in plain] = ['Ã¼Ã¼Ã¼', '$D$$', '\x0c', '\x0c', 'Â»Ã›Ã›Â»', '\x0c', 'Ã¹\x99Ã¹', '\x81\x81', "'''", 'Ã', 'Ã¼Ã¼Ã¼', '$D$$', '\x0c', '\x0c', 'Â»Ã›Ã›Â»', '\x0c', 'Ã¹\x99Ã¹', '\x81\x81', "'''", 'Ã', 'i\t\t', '\x81\x81', 'Ã˜Ã˜Ã˜', '\x88Ã¨', 'Â»Ã›Ã›Â»', 'Â»Ã›Ã›Â»', '\x0c', '\x88Ã¨', 'Ã¹\x99Ã¹', '\x81\x81', "'''", 'Ã', 'Â¥Â¥', '\x06f', 'Ã˜Ã˜Ã˜', '_', '\x88Ã¨', '\x06f', '_', '\x0c', 'Ã¹\x99Ã¹', '\x81\x81', "'''", '\xa0Ã€\xa0Ã€\xa0\xa0']

f(0~255)ë¥¼ ë‹¤ í•´ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤.


secret = 'Sleeperio Sleeperio Disappeario Instanterio!'
flag = 'corctf{4l1c3_15_1n_d33p_tr0ubl3_b3c4us3_1_d1d_n0t_s4v3_h3r!!:c}'
